<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="pageTitle">Financial Tips</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f5f5f5;
        }
        .container {
            padding: 20px;
            background-color: #f5f5f5;
            min-height: 100vh;
        }
        .loading-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .back-link {
            color: #007bff;
            margin-bottom: 15px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
        }
        .back-link:hover {
            text-decoration: underline;
        }
        .title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            text-align: center;
        }
        /* New styling for the tips grid */
        .tips-grid {
            display: grid;
            gap: 12px;
            /* Responsive grid for different screen sizes */
            grid-template-columns: repeat(1, minmax(0, 1fr));
        }

        /* Responsive behavior for larger screens */
        @media (min-width: 640px) { /* sm breakpoint */
            .tips-grid {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
        }

        @media (min-width: 1024px) { /* lg breakpoint */
            .tips-grid {
                grid-template-columns: repeat(3, minmax(0, 1fr));
            }
        }
        
        .tip-card {
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            font-size: 16px;
            color: #fff; /* White text for contrast */
            cursor: pointer;
            transition-property: transform;
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
            transition-duration: 200ms;
        }
        .tip-card:hover {
            transform: scale(1.03); /* Hover effect to scale up slightly */
        }
        .section {
            margin-top: 25px;
            background-color: #fff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .subtitle {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 10px;
            color: #333;
        }
        .quote {
            font-style: italic;
            font-size: 17px;
            margin-bottom: 10px;
            color: #444;
            line-height: 24px;
        }
        .author {
            font-size: 15px;
            color: #666;
            text-align: right;
            margin-bottom: 5px;
        }
        .reminder {
            background-color: #e0f7fa;
            border-left: 5px solid #00bcd4;
            padding: 15px;
            margin-top: 25px;
            border-radius: 8px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }
        .reminder-text {
            font-size: 16px;
            color: #333;
            line-height: 22px;
        }
    </style>
</head>
<body class="bg-gray-100">

    <!-- Language Selector -->
    <div class="absolute top-4 right-4 z-20">
        <select id="language-selector" class="bg-white border border-gray-300 rounded-lg p-2 text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
            <option value="en">English</option>
            <option value="fr">Fran√ßais</option>
        </select>
    </div>

    <div id="app-root" class="container">
        <!-- Content will be rendered here by JavaScript -->
    </div>

    <script>
        // --- TRANSLATION DATA ---
        const translations = {
            en: {
                pageTitle: "Financial Tips",
                backLink: "‚Üê Back to Dashboard",
                mainTitle: "üí° Financial Tips",
                weeklyQuote: "üìå Weekly Quote",
                loadingMessage: "Loading financial tips...",
                reminder_no_goal: "üßæ You haven‚Äôt set a new savings goal this week. Don‚Äôt forget to plan ahead!",
                reminder_goal_set: (amount) => `‚úÖ Great job! You‚Äôve set a saving goal of GHS ${amount}. Keep it up!`,
                reminder_high_expense: (amount) => `‚ö†Ô∏è You spent GHS ${amount}. Balance your budget with a saving goal.`,
                reminder_error: "Error loading financial reminders.",
                tips: [
                    "Track Your Spending: Know where every cedi goes. Use budgeting apps or spreadsheets.",
                    "Create a Weekly Budget: Plan your allowance. Set aside for food, transport, and savings.",
                    "Follow the 50/30/20 Rule: 50% on needs, 30% on wants, 20% savings.",
                    "Start Saving Early: Even GHS 2 daily adds up. Set goals and reward progress.",
                    "Avoid Unnecessary Debt: Borrow only when necessary. Know the terms.",
                    "Make Informed Decisions: Ask before buying: 'Do I need this? Is this the best deal?'",
                    "Compare Prices: Avoid overspending by checking vendors.",
                    "Build an Emergency Fund: Save weekly for unexpected costs.",
                    "Practice Delayed Gratification: Wait on non-essentials to avoid regret.",
                    "Review Weekly: Evaluate your spending, saving, and plan for next week."
                ],
                quotes: [
                    { text: "Do not save what is left after spending, but spend what is left after saving.", author: "Warren Buffett" },
                    { text: "A budget is telling your money where to go instead of wondering where it went.", author: "Dave Ramsey" },
                    { text: "Wealth consists not in having great possessions, but in having few wants.", author: "Epictetus" },
                    { text: "Beware of little expenses; a small leak will sink a great ship.", author: "Benjamin Franklin" },
                    { text: "Financial freedom is available to those who learn about it and work for it.", author: "Robert Kiyosaki" },
                    { text: "It‚Äôs not your salary that makes you rich, it‚Äôs your spending habits.", author: "Charles A. Jaffe" },
                    { text: "Money looks better in the bank than on your feet.", author: "Sophia Amoruso" },
                    { text: "Save money and money will save you.", author: "Evans Buckman" },
                    { text: "Success is not final, failure is not fatal: it is the courage to continue that counts.", author: "Winston Churchill" },
                    { text: "Believe you can and you're halfway there.", author: "Theodore Roosevelt" },
                    { text: "The only way to do great work is to love what you do.", author: "Steve Jobs" },
                    { text: "You miss 100% of the shots you don‚Äôt take.", author: "Wayne Gretzky" },
                    { text: "Start where you are. Use what you have. Do what you can.", author: "Arthur Ashe" }
                ]
            },
            fr: {
                pageTitle: "Conseils financiers",
                backLink: "‚Üê Retour au tableau de bord",
                mainTitle: "üí° Conseils financiers",
                weeklyQuote: "üìå Citation de la semaine",
                loadingMessage: "Chargement des conseils financiers...",
                reminder_no_goal: "üßæ Vous n'avez pas fix√© de nouvel objectif d'√©pargne cette semaine. N'oubliez pas de planifier √† l'avance !",
                reminder_goal_set: (amount) => `‚úÖ Bon travail ! Vous avez fix√© un objectif d'√©pargne de GHS ${amount}. Continuez comme √ßa !`,
                reminder_high_expense: (amount) => `‚ö†Ô∏è Vous avez d√©pens√© GHS ${amount}. √âquilibrez votre budget avec un objectif d'√©pargne.`,
                reminder_error: "Erreur lors du chargement des rappels financiers.",
                tips: [
                    "Suivez vos d√©penses : sachez o√π va chaque cedi. Utilisez des applications ou des feuilles de calcul budg√©taires.",
                    "Cr√©ez un budget hebdomadaire : planifiez votre argent de poche. Mettez de c√¥t√© pour la nourriture, le transport et l'√©pargne.",
                    "Suivez la r√®gle 50/30/20 : 50% pour les besoins, 30% pour les d√©sirs, 20% pour l'√©pargne.",
                    "Commencez √† √©pargner t√¥t : m√™me 2 GHS par jour s'accumulent. Fixez des objectifs et r√©compensez vos progr√®s.",
                    "√âvitez les dettes inutiles : empruntez uniquement en cas de n√©cessit√©. Connaissez les termes.",
                    "Prenez des d√©cisions √©clair√©es : demandez-vous avant d'acheter : 'Ai-je besoin de cela ? Est-ce la meilleure affaire ?'",
                    "Comparez les prix : √©vitez de trop d√©penser en v√©rifiant les vendeurs.",
                    "Constituez un fonds d'urgence : √©pargnez chaque semaine pour les co√ªts impr√©vus.",
                    "Pratiquez la gratification diff√©r√©e : attendez pour les non-essentiels afin d'√©viter les regrets.",
                    "Passez en revue chaque semaine : √©valuez vos d√©penses, votre √©pargne et planifiez la semaine prochaine."
                ],
                quotes: [
                    { text: "Ne gardez pas ce qui reste apr√®s avoir d√©pens√©, mais d√©pensez ce qui reste apr√®s avoir √©pargn√©.", author: "Warren Buffett" },
                    { text: "Un budget, c'est dire √† votre argent o√π aller au lieu de vous demander o√π il est pass√©.", author: "Dave Ramsey" },
                    { text: "La richesse ne consiste pas √† avoir de grandes possessions, mais √† avoir peu de d√©sirs.", author: "√âpict√®te" },
                    { text: "M√©fiez-vous des petites d√©penses ; une petite fuite peut faire sombrer un grand navire.", author: "Benjamin Franklin" },
                    { text: "La libert√© financi√®re est accessible √† ceux qui l'apprennent et y travaillent.", author: "Robert Kiyosaki" },
                    { text: "Ce n'est pas votre salaire qui vous rend riche, ce sont vos habitudes de d√©penses.", author: "Charles A. Jaffe" },
                    { text: "L'argent est plus beau √† la banque que sur vos pieds.", author: "Sophia Amoruso" },
                    { text: "√âpargnez de l'argent et l'argent vous √©pargnera.", author: "Evans Buckman" },
                    { text: "Le succ√®s n'est pas final, l'√©chec n'est pas fatal : c'est le courage de continuer qui compte.", author: "Winston Churchill" },
                    { text: "Croyez que vous le pouvez et vous √™tes √† mi-chemin.", author: "Theodore Roosevelt" },
                    { text: "La seule fa√ßon de faire du bon travail est d'aimer ce que vous faites.", author: "Steve Jobs" },
                    { text: "Vous ratez 100 % des tirs que vous ne tentez pas.", author: "Wayne Gretzky" },
                    { text: "Commencez l√† o√π vous √™tes. Utilisez ce que vous avez. Faites ce que vous pouvez.", author: "Arthur Ashe" }
                ]
            }
        };

        // Mocking React Native/Expo dependencies for the browser environment
        const router = {
            push: (path) => {
                // In a real app, this would change the URL. Here, we can just navigate.
                console.log(`Navigating to ${path}`);
                window.location.href = path; // Simple navigation for this example
            }
        };

        // Mocking AsyncStorage with localStorage
        const AsyncStorage = {
            getItem: (key) => Promise.resolve(localStorage.getItem(key)),
            setItem: (key, value) => Promise.resolve(localStorage.setItem(key, value)),
        };
        
        // A palette of attractive pastel colors for the tip cards
        const tipColors = [
            "#60A5FA", // Blue-400
            "#F87171", // Red-400
            "#FACC15", // Yellow-400
            "#4ADE80", // Green-400
            "#A78BFA", // Violet-400
            "#FB923C", // Orange-400
            "#E879F9", // Magenta-400
            "#38BDF8"  // Sky-400
        ];

        // Helper function to get ISO week number, ported from the original code
        function getWeekNumber() {
            const date = new Date();
            date.setUTCDate(date.getUTCDate() + 4 - (date.getUTCDay() || 7));
            const yearStart = new Date(Date.UTC(date.getUTCFullYear(), 0, 4));
            const weekNo = Math.ceil((((date.getTime() - yearStart.getTime()) / 86400000) + 1) / 7);
            return weekNo;
        }

        // State-like object to manage UI data
        const state = {
            quote: null,
            reminderMessage: '',
            isLoading: true,
            currentLang: 'en'
        };

        /**
         * Translates all elements with a data-i18n attribute and dynamically
         * updates page content based on the selected language.
         */
        function translatePage(lang) {
            state.currentLang = lang;
            document.documentElement.lang = lang; // Set the HTML lang attribute
            const currentTranslations = translations[lang];

            // Translate static elements
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (currentTranslations[key]) {
                    element.textContent = currentTranslations[key];
                }
            });
            render();
        }

        // Renders the UI based on the current state
        function render() {
            const root = document.getElementById('app-root');
            root.innerHTML = ''; // Clear existing content
            const currentTranslations = translations[state.currentLang];

            if (state.isLoading) {
                root.innerHTML = `
                    <div class="loading-container">
                        <svg class="animate-spin h-12 w-12 text-blue-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        <p class="mt-4 text-base text-gray-600">${currentTranslations.loadingMessage}</p>
                    </div>
                `;
                return;
            }

            // Main UI content
            root.innerHTML = `
                <div class="financial-screen-content">
                    <a href="/dashboard.html" class="back-link" data-i18n="backLink">‚Üê Back to Dashboard</a>

                    <h1 class="title" data-i18n="mainTitle">üí° Financial Tips</h1>
                    
                    <!-- Updated section for tips with grid layout -->
                    <div class="tips-grid">
                        ${currentTranslations.tips.map((tip, index) => {
                            const color = tipColors[index % tipColors.length];
                            return `<div class="tip-card" style="background-color: ${color};">
                                ${tip}
                            </div>`;
                        }).join('')}
                    </div>

                    <div class="section">
                        <h2 class="subtitle" data-i18n="weeklyQuote">üìå Weekly Quote</h2>
                        <p class="quote">‚Äú${state.quote.text}‚Äù</p>
                        <p class="author">‚Äì ${state.quote.author}</p>
                    </div>

                    <div class="reminder">
                        <p class="reminder-text">${state.reminderMessage}</p>
                    </div>
                </div>
            `;
        }

        // Main function to fetch data and update UI
        async function fetchFinancialData() {
            state.isLoading = true;
            render();
            const currentTranslations = translations[state.currentLang];

            try {
                // Set weekly quote based on week number
                const quotes = currentTranslations.quotes;
                const weekIndex = getWeekNumber() % quotes.length;
                state.quote = quotes[weekIndex];

                // Fetch data from localStorage (mocking AsyncStorage)
                const lastBudgetStr = await AsyncStorage.getItem('lastExpenseAmount');
                const lastType = await AsyncStorage.getItem('lastExpenseType');

                const lastBudget = parseFloat(lastBudgetStr || '0');
                const lastBudgetType = lastType || 'none';

                let message;
                if (lastBudgetType === 'goal') {
                    message = currentTranslations.reminder_goal_set(lastBudget);
                } else if (lastBudgetType === 'expense' && lastBudget > 100) {
                    message = currentTranslations.reminder_high_expense(lastBudget);
                } else {
                    message = currentTranslations.reminder_no_goal;
                }
                state.reminderMessage = message;
            } catch (error) {
                console.error('Failed to load financial data from localStorage', error);
                state.reminderMessage = currentTranslations.reminder_error;
            } finally {
                state.isLoading = false;
                render();
            }
        }

        // Initial language setting and data fetch
        document.addEventListener('DOMContentLoaded', () => {
            const languageSelector = document.getElementById('language-selector');
            const userLang = navigator.language.split('-')[0];
            if (translations[userLang]) {
                languageSelector.value = userLang;
            }
            languageSelector.addEventListener('change', (event) => {
                translatePage(event.target.value);
            });
            translatePage(languageSelector.value);
            fetchFinancialData();
        });
    </script>
</body>
</html>